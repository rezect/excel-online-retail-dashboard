# Excel Middle Project — Online Retail (UCI)
**Контекст данных:** построчные транзакции интернет‑магазина (InvoiceNo/StockCode/Quantity/UnitPrice/InvoiceDate/CustomerID/Country), где InvoiceNo, начинающийся с "C", означает отмену; UnitPrice в фунтах стерлингов. [web:1]

---

## Спринт 0 — Подготовка и оформление проекта
### Цели
- Зафиксировать бизнес-задачу и границы проекта.
- Подготовить структуру Excel‑книги, правила именования, документацию.

### Артефакты (что должно появиться)
- Лист `README`:
  - Описание датасета и ссылки на источник/лицензию. [web:1]
  - Бизнес-вопросы (пример): динамика выручки, топ‑страны, топ‑товары, удержание/частота покупок, доля отмен. [web:1]
- Лист `Metrics Dictionary`:
  - Определения метрик (Revenue, Orders, AOV, Cancel Rate и т. п.) и правила расчёта, включая трактовку отмен через InvoiceNo="C…". [web:1]
- Структура листов (минимум):
  - `README`, `Metrics Dictionary`, `Control` (параметры), `Data_Quality`, `Dashboard`, `Customers`, `Products`.
- Принятые конвенции:
  - Имена запросов Power Query: `stg_*`, `dim_*`, `fct_*`.
  - Имена мер DAX: префикс вроде `m_` (например, `m_Revenue`).

### Acceptance criteria
- Любой человек, открыв файл, понимает: откуда данные, что считается, какие ограничения. [web:1]

---

## Спринт 1 — Импорт и первичная очистка (Power Query основы)
### Цели
- Поднять устойчивый импорт из исходного `Online Retail.xlsx`.
- Привести типы, добавить базовые вычисляемые поля.

### Power Query задачи
- Создать запрос `stg_sales_raw` (источник: Excel‑файл датасета). [web:1]
- Привести типы:
  - `InvoiceDate` → datetime; `Quantity`, `UnitPrice` → number; `CustomerID` → (часто лучше text/whole number по ситуации). [web:1]
- Добавить столбцы:
  - `IsCancellation` = InvoiceNo начинается с "C" (правило датасета). [web:1]
  - `LineRevenue` = Quantity * UnitPrice. [web:1]
- Минимальные проверки качества (лист `Data_Quality` как таблица/сводка):
  - Кол-во строк, % пропусков CustomerID, диапазон дат, наличие отрицательных Quantity/UnitPrice (зафиксировать как наблюдение/правило). [web:1]

### Acceptance criteria
- `Refresh All` обновляет staging без ручных правок.
- Типы и вычисляемые поля воспроизводимы при каждом обновлении. [web:1]

---

## Спринт 2 — Нормализация и модель данных (звезда)
### Цели
- Превратить “плоскую таблицу” в модель как мини‑БД: факт + измерения.
- Загрузить всё в Data Model.

### Power Query задачи
- `fct_Sales` (факт): оставить только нужные поля + ключи.
- `dim_Product`: DISTINCT по `StockCode`, `Description`. [web:1]
- `dim_Customer`: DISTINCT по `CustomerID`, `Country`. [web:1]
- `dim_Country` (опционально): DISTINCT по `Country`. [web:1]
- `dim_Date`: календарь (можно генерировать в PQ) на диапазон `InvoiceDate`. [web:1]

### Data Model задачи
- Создать связи (Fact → Dims) и проверить однозначность ключей.
- Запретить “подтягивание” данных формулами по листам (никаких VLOOKUP как костылей) — только модель/меры.

### Acceptance criteria
- В PivotTable доступно срезать выручку по Date/Product/Customer/Country без дополнительных join‑таблиц на листах. [web:41]

---

## Спринт 3 — Базовые DAX‑меры и KPI слой
### Цели
- Построить ядро показателей, которые будут использоваться во всех отчётах.
- Освоить “measure vs calculated column”, контекст и базовые функции.

### DAX (минимальный набор мер)
- `m_Revenue` (на основе LineRevenue или через SUMX по Quantity*UnitPrice).
- `m_Orders` = DISTINCTCOUNT(InvoiceNo) (с отдельной логикой: все/без отмен).
- `m_Customers` = DISTINCTCOUNT(CustomerID).
- `m_AOV` = Revenue / Orders (через DIVIDE).
- `m_CancelledOrders` и/или `m_CancelRate` (используя `IsCancellation` из правила InvoiceNo="C"). [web:1]
- `m_ItemsSold` = SUM(Quantity) (отдельно обдумать: включать ли отмены).

### Acceptance criteria
- Все KPI пересчитываются при фильтрах (slicers) по Country/Date/Product. [web:25]

---

## Спринт 4 — Time Intelligence (время как “must-have” middle)
### Цели
- Сделать временную аналитику на календаре и сравнение периодов.

### Задачи
- Пометить `dim_Date` как Date table (если требуется в вашей версии Excel/Power Pivot).
- Реализовать меры:
  - `m_Revenue_MTD`, `m_Revenue_YTD`.
  - (опционально) сравнение с предыдущим периодом (MoM) и доля изменения.
- Проверить корректность на границах месяцев/года (особенно если время в InvoiceDate). [web:1]

### Acceptance criteria
- На графике по месяцам/неделям корректно считается выручка и её MTD/YTD без ручных диапазонов. [web:25]

---

## Спринт 5 — Dashboard (визуал, UX, интерактив)
### Цели
- Собрать 1 главный дашборд “для бизнеса” с управляемыми фильтрами.

### Состав дашборда
- KPI карточки: Revenue, Orders, AOV, Customers, Cancel Rate. [web:25]
- Графики:
  - Revenue по времени (месяц/неделя).
  - Top‑10 Countries по Revenue.
  - Top‑10 Products по Revenue.
- Срезы (slicers): Country, Year/Month (из `dim_Date`). [web:1]

### Требования к оформлению
- Единые подписи и единицы (валюта — фунты стерлингов из описания датасета). [web:1]
- Лист `Control`: параметры (например, дата “as of”, пороги сегментов) — чтобы потом легко менять логику без переписывания всего файла.

### Acceptance criteria
- Дашборд открывается “как продукт”: фильтры понятны, KPI читабельны, ничего не ломается при Refresh.

---

## Спринт 6 — Customers: RFM сегментация (middle+)
### Цели
- Научиться строить поведенческие метрики клиентов и сегменты.

### Задачи
- Выбрать “дату анализа” (например, max(InvoiceDate) в данных).
- Посчитать RFM:
  - Recency: дней с последней покупки.
  - Frequency: число заказов (distinct InvoiceNo).
  - Monetary: выручка.
- Присвоить скоринг (например, 1–5 по квантилям) и собрать сегменты.
- Визуализации: распределение клиентов по сегментам, топ‑сегменты по выручке.

### Acceptance criteria
- Сегменты пересчитываются при фильтрах (например, по Country) и после обновления данных. [web:25]

---

## Спринт 7 — Products: ABC/Pareto + отмены
### Цели
- Сделать продуктовую аналитику: какие товары дают основную выручку, какие “проблемные” по отменам.

### Задачи
- ABC по выручке:
  - Доля товара в выручке.
  - Кумулятивная доля и класс A/B/C (например, 80/15/5) — пороги в `Control`.
- “Проблемность”:
  - Доля отмен по товару (используя `IsCancellation` из правила InvoiceNo="C"). [web:1]
- Визуализации: таблица A/B/C, топ отменяемых товаров.

### Acceptance criteria
- ABC обновляется динамически при фильтрах и после Refresh (без ручной сортировки). [web:25]

---

## Спринт 8 — Data Quality и бизнес-правила (как в реальном проекте)
### Цели
- Зафиксировать правила обработки спорных строк и сделать мониторинг качества.

### Задачи
- Лист `Data_Quality` с метриками:
  - % строк без CustomerID; количество отмен (по InvoiceNo="C") и их доля; отрицательные Quantity/UnitPrice. [web:1]
- Решения и допущения (в `README`):
  - Считать ли отрицательные Quantity как возвраты; исключать ли строки с нулевой/отрицательной ценой; как считать Orders при отменах. [web:1]
- (опционально) “слои” факта:
  - `fct_Sales_All` и `fct_Sales_Net` (net = без отмен/под выбранную бизнес-логику).

### Acceptance criteria
- Любой спорный момент имеет явное правило и отражён в документации, а не “скрыт” в формулах. [web:1]

---

## Спринт 9 — Финализация и упаковка (портфолио-готово)
### Цели
- Сделать проект завершённым, переносимым и проверяемым.

### Чек-лист
- `README` содержит:
  - бизнес-цели, датасет/ссылки, словарь метрик, принятые допущения, список листов и как пользоваться дашбордом. [web:1]
- “Технический паспорт”:
  - Список Power Query запросов и назначение каждого.
  - Список DAX мер и краткие определения.
- Проверка воспроизводимости:
  - Удалить кеши/лишние листы, убедиться, что `Refresh All` отрабатывает на чистом запуске.
- Экспорт артефактов:
  - Скриншоты дашборда (для резюме/портфолио) + короткое описание.

### Acceptance criteria
- Файл можно передать другому человеку вместе с исходным `Online Retail.xlsx`, и он сможет обновить и пользоваться отчётом без объяснений “на словах”. [web:41]
